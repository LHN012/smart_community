<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.wx_smart_community.mapper.MaintenanceRequestMapper">
    
    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.example.wx_smart_community.entity.MaintenanceRequest">
        <id column="request_id" property="requestId"/>
        <result column="user_id" property="userId"/>
        <result column="location" property="location"/>
        <result column="description" property="description"/>
        <result column="status" property="status"/>
        <result column="created_at" property="createdAt"/>
        <result column="update_user_id" property="updateUserId"/>
        <result column="updated_at" property="updatedAt"/>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        request_id, user_id, location, description, status, created_at, update_user_id, updated_at
    </sql>

    <!-- 根据用户ID查询报修请求列表 -->
    <select id="selectByUserId" resultMap="BaseResultMap">
        SELECT 
            request_id,
            user_id,
            location,
            description,
            status,
            created_at,
            update_user_id,
            updated_at
        FROM maintenancerequests
        WHERE user_id = #{userId}
        ORDER BY created_at DESC
    </select>

</mapper> 